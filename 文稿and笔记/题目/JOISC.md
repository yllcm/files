## JOISC2023

### loj3966. 「JOISC 2023 Day1」两种货币

咋看着这么像主席树板子。

### *loj3967. 「JOISC 2023 Day1」JOI 国の节日 2

最近咋这么多题差一步/fn

让我翻翻草稿本。

首先发现计数序列等价于计数配对方案。然后发现真实的最优解是按照右端点排序选。

那么能不能考虑确定每个数的配对情况的同时确定答案呢？可以的，所以可以设计状态 $(i,j,k,x,y)$ 表示答案分别为 $j,k$，有 $x$ 个左端点没匹配，$y$ 个左端点是在最优解最后一个右端点出现的。这样是五次方。

发现只关心 $j-k$，四次方。

发现 $j-k\leq 1$，三次方。

然后怎么搞呢？其实可以注意到 $x,y$ 都在系数里面，所以可以尝试把它放进决策里面之类的技巧。或者尝试拿转移换状态，但是转移的系数非常麻烦。

不过可以发现 $x-y$ 其实比较无关紧要，因为这些区间既不包含在贪心解也不包含在最优解里面，所以可以尝试把这些左端点先解决掉，之后就不要考虑它们的状态了。

但是，有问题啊！假如说我们为它钦定了右端点，但是在真实的右端点处不还是要做一步决策吗？这样不是有后效性了吗？

其实很简单，由于确定了这些位置之后并不影响其它决策，将这些右端点忽略即可。

卡在最后一句话了，火大。

### loj3968. 「JOISC 2023 Day1」护照

口胡，感觉不难？

题意相当于求最小集合 $S$，满足 $S$ 覆盖 $[1,n]$ 并且 $X_i\in S$。

那么先把 $X_i$ 加进去，之后就变成了求最小集合 $S$ 使得 $S$ 覆盖 $[1,L_{X_i})\cup(R_{X_i},n]$。拆开变成求覆盖前缀和后缀，这里只讨论前缀。

那么设 $f_i$ 表示覆盖 $i$ 前缀的答案，转移形如 $f_{i}=\min f_j+1$，条件是存在区间同时包含 $[i,j]$。

那么线段树一下就可以了？

我测，这个覆盖可能有交。

哦但是如果有交的话就跟 $X$ 没啥关系了，可以尝试把没有后面一个条件的最优解 $+1$。

## JOISC2017

### *loj2391. 「JOISC 2017 Day 1」港口设施

一年前我看这题只会对着题解抄，现在重新看一下写出来了，令人感慨。

考虑相交不包含的区间建立图，图合法当且仅当其为二分图，方案数为 $2^c$，$c$ 为联通块数。暴力做 $\mathcal{O}(n^2)$。

现在我们需要一个满足图的二分性和连通性的优化建图方式。观察一下可以发现，对于已经确定在二分图同侧的区间，我们可以把它们缩起来。设计如下算法：从大到小遍历，遍历到左端点的时候，暴力找到所有合法连续段，并连边，连边完成之后，把这些段缩起来，并删除其右端点。删除的方式是：利用并查集维护某个点右侧第一个未被删除的点，容易维护。

复杂度 $\mathcal{O}(n\log n)$。